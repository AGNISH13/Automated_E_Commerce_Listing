from utils.genai import llm

# Define a function to identify the product from the transcript and object detections
def identify_product(transcript, object_ids):
    # Format the prompt
    prompt = f"""
    You are an AI assistant that identifies the advertised product from visual object detections and textual descriptions.

    Given the following information:

    Transcript of an advertisement:
    {transcript}

    MSCOCO object ids:
    {object_ids}

    Identify the product being advertised in terms of given object ids and rank them from most likely to least likely. Select only the top class and return the output class name as a python list of strings.
    """
    # Generate the response
    response = llm(prompt)
    return response

# # Example input: Transcript and object detections
# transcript = """
# [00:00.000 --> 00:02.000]  Who can it be now?
# [00:04.000 --> 00:06.000]  Who can it be now?
# """

# # object_ids = object_id
# object_ids = [{'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 67, 'class_name': 'cell phone'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 67, 'class_name': 'cell phone'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 24, 'class_name': 'backpack'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 9, 'class_name': 'traffic light'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 58, 'class_name': 'potted plant'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 9, 'class_name': 'traffic light'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 9, 'class_name': 'traffic light'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 9, 'class_name': 'traffic light'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 9, 'class_name': 'traffic light'}, {'class_id': 12, 'class_name': 'parking meter'}, {'class_id': 12, 'class_name': 'parking meter'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 12, 'class_name': 'parking meter'}, {'class_id': 10, 'class_name': 'fire hydrant'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 19, 'class_name': 'cow'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 17, 'class_name': 'horse'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 16, 'class_name': 'dog'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 26, 'class_name': 'handbag'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 26, 'class_name': 'handbag'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 9, 'class_name': 'traffic light'}, {'class_id': 9, 'class_name': 'traffic light'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 13, 'class_name': 'bench'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 2, 'class_name': 'car'}, {'class_id': 26, 'class_name': 'handbag'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 26, 'class_name': 'handbag'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 10, 'class_name': 'fire hydrant'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 36, 'class_name': 'skateboard'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 10, 'class_name': 'fire hydrant'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 13, 'class_name': 'bench'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}, {'class_id': 0, 'class_name': 'person'}]

# # Example object detections (YOLOv8 output)
# # object_detections = [44, 46]  # 44 = bottle, 46 = wine glass

# # Call the function
# identified_product = identify_product(transcript, object_ids)

# # Print the result
# print("Identified Product:", identified_product)